var Qowaiv;
(function (Qowaiv) {
    class Guid {
        constructor() {
            this.v = '00000000-0000-0000-0000-000000000000';
        }
        toString() {
            return this.v;
        }
        format(f) {
            switch (f) {
                case 'B': return '{' + this.v + '}';
                case 'b': return '{' + this.v.toLowerCase() + '}';
                case 'S': return this.v.replace(/-/g, '');
                case 's': return this.v.replace(/-/g, '').toLowerCase();
                case 'l': return this.v.toLowerCase();
                case 'U':
                case 'u':
                default: return this.v;
            }
        }
        toJSON() {
            return this.v;
        }
        static fromJSON(s) {
            return Guid.parse(s);
        }
        equals(other) {
            return other !== null &&
                other !== undefined &&
                other instanceof (Guid) &&
                other.v === this.v;
        }
        static isValid(s) {
            return /^[0-9ABCDEF]{32}$/i.test(s.replace(/-/g, ''));
        }
        static parse(s) {
            if (s === '') {
                return new Guid();
            }
            if (Guid.isValid(s)) {
                var val = new Guid();
                s = s.replace(/-/g, '').toUpperCase();
                val.v = s.replace(/(.{8})(.{4})(.{4})(.{4})(.{8})/, '$1-$2-$3-$4-$5');
                return val;
            }
            return null;
        }
        static newGuid() {
            var guid = new Guid();
            guid.v = Guid.rndGuid(false) + Guid.rndGuid(true) + Guid.rndGuid(true) + Guid.rndGuid(false);
            return guid;
        }
        static rndGuid(s) {
            var p = (Math.random().toString(16) + '000000000').substr(2, 8);
            return s ? "-" + p.substr(0, 4) + '-' + p.substr(4, 4) : p;
        }
    }
    Qowaiv.Guid = Guid;
})(Qowaiv || (Qowaiv = {}));
var Qowaiv;
(function (Qowaiv) {
    class TimeSpan {
        constructor(d, h, m, s, f) {
            this.v = this.num(d) * 86400;
            this.v += this.num(h) * 3600;
            this.v += this.num(m) * 60;
            this.v += this.num(s);
            this.v += this.num(f) * 0.001;
        }
        num(n) {
            return isNaN(n) ? 0 : n;
        }
        getDays() {
            return ~~(this.v / 86400);
        }
        getHours() {
            return ~~((this.v / 3600) % 24);
        }
        getMinutes() {
            return ~~((this.v / 60) % 60);
        }
        getSeconds() {
            return ~~(this.v % 60);
        }
        getMilliseconds() {
            return ~~((this.v * 1000) % 1000);
        }
        getTotalDays() {
            return this.v / 86400.0;
        }
        getTotalHours() {
            return this.v / 3600.0;
        }
        getTotalMinutes() {
            return this.v / 60.0;
        }
        getTotalSeconds() {
            return this.v;
        }
        getTotalMilliseconds() {
            return this.v * 1000.0;
        }
        getTicks() {
            return ~~(this.v * 10000000);
        }
        multiply(factor) {
            if (isNaN(factor)) {
                throw Error("factor is not a number.");
            }
            return TimeSpan.fromSeconds(this.v * factor);
        }
        divide(factor) {
            if (isNaN(factor)) {
                throw Error("factor is not a number.");
            }
            if (factor === 0) {
                throw Error("factor is zero.");
            }
            return TimeSpan.fromSeconds(this.v / factor);
        }
        toString() {
            var s = this.getTotalSeconds() % 60;
            var m = this.getMinutes();
            var h = this.getHours();
            var d = this.getDays();
            var str = '';
            if (str !== '' || d !== 0) {
                str += d + ':';
            }
            if (str !== '' && h < 10) {
                str += '0';
            }
            if (str !== '' || h !== 0) {
                str += h + ':';
            }
            if (str !== '' && m < 10) {
                str += '0';
            }
            if (str !== '' || m !== 0) {
                str += m + ':';
            }
            if (str !== '' && s < 10) {
                str += '0';
            }
            if (str !== '' || s !== 0) {
                str += s;
            }
            return str;
        }
        format(format) {
            var sec = Math.round(this.v);
            var ts = TimeSpan.fromSeconds(sec);
            return ts.toString();
        }
        toJSON() {
            return this.toString();
        }
        static fromJSON(s) {
            return TimeSpan.parse(s);
        }
        equals(other) {
            return other !== null &&
                other !== undefined &&
                other instanceof (TimeSpan) &&
                other.v === this.v;
        }
        static isValid(s) {
            return typeof (s) === 'string' && TimeSpan.pattern.test(s);
        }
        static parse(str) {
            if (TimeSpan.isValid(str)) {
                var bl = str.split(':');
                var l = bl.length;
                var s = parseFloat(bl[l - 1].replace(',', '.'));
                var d = (l > 3) ? parseInt(bl[l - 4]) : 0;
                var h = (l > 2) ? parseInt(bl[l - 3]) : 0;
                var m = (l > 1) ? parseInt(bl[l - 2]) : 0;
                return new TimeSpan(d, h, m, s);
            }
            return null;
        }
        static fromSeconds(seconds) {
            if (isNaN(seconds)) {
                throw Error("seconds is not a number.");
            }
            return new TimeSpan(0, 0, 0, seconds);
        }
    }
    TimeSpan.pattern = /^\d*((((\d+:(2[0-3]|[0-1]\d)|\d)?:[0-5])?\d:)?[0-5])?\d([,\.]\d+)?$/;
    Qowaiv.TimeSpan = TimeSpan;
})(Qowaiv || (Qowaiv = {}));
